import { hashPassword } from '../lib/auth';
import { buildTranslations } from '../lib/translation';
import { DatabaseSnapshot, Message } from '../types/models';

const PASSWORD = hashPassword('123456');

function makeMessage(message: Omit<Message, 'translations'>): Message {
  return {
    ...message,
    translations: buildTranslations(message.text_original, message.lang_original),
  };
}

const seed: DatabaseSnapshot = {
  school: {
    id: 'school_1',
    name: 'Школьный кабинет Израиль (прототип)',
    timezone: 'Asia/Jerusalem',
    enabled_languages: ['he', 'ru', 'en'],
    auto_translate_enabled: true,
  },
  users: [
    {
      id: 'user_director_1',
      name: 'Татьяна',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=Tatyana',
      login: 'director1',
      password_hash: PASSWORD,
      role_id: 1,
      preferred_language: 'ru',
      is_homeroom: false,
      class_ids: ['class_g1'],
      child_ids: [],
      is_active: true,
      dob: '1978-05-12',
      show_birthday_in_calendar: true,
      phone: '+972500000001',
      email: 'director1@school.local',
      document_type: 'teudat_zeut',
      document_number: 'D-100001',
      initial_password: '123456',
    },
    {
      id: 'user_admin_7',
      name: 'Ольга Администратор',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=OlgaAdmin',
      login: 'admin7',
      password_hash: PASSWORD,
      role_id: 7,
      preferred_language: 'ru',
      is_homeroom: false,
      class_ids: ['class_g1'],
      child_ids: [],
      is_active: true,
      dob: '1987-11-03',
      show_birthday_in_calendar: true,
      phone: '+972500000007',
      email: 'admin7@school.local',
      document_type: 'teudat_zeut',
      document_number: 'A-700001',
      initial_password: '123456',
    },
    {
      id: 'user_teacher_1',
      name: 'Инна',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=Inna',
      login: 'teacher3',
      password_hash: PASSWORD,
      role_id: 3,
      preferred_language: 'ru',
      is_homeroom: false,
      teaching_subjects: ['Иврит', 'Математика', 'Естествознание'],
      class_ids: ['class_g1'],
      child_ids: [],
      is_active: true,
      dob: '1989-02-21',
      show_birthday_in_calendar: true,
      phone: '+972500000003',
      email: 'teacher3@school.local',
      document_type: 'passport',
      document_number: 'T-300001',
      initial_password: '123456',
    },
    {
      id: 'user_parent_1',
      name: 'Александр Аракчеев',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=AlexanderParent',
      login: 'parent4',
      password_hash: PASSWORD,
      role_id: 4,
      preferred_language: 'ru',
      is_homeroom: false,
      class_ids: ['class_g1'],
      child_ids: ['user_student_1'],
      is_active: true,
      dob: '1985-08-14',
      show_birthday_in_calendar: true,
      phone: '+972500000004',
      email: 'parent4@school.local',
      document_type: 'teudat_zeut',
      document_number: 'P-400001',
      initial_password: '123456',
    },
    {
      id: 'user_student_1',
      name: 'Марк Аракчеев',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=MarkStudent',
      login: 'student5',
      password_hash: PASSWORD,
      role_id: 5,
      preferred_language: 'ru',
      is_homeroom: false,
      class_ids: ['class_g1'],
      child_ids: [],
      is_active: true,
      dob: '2014-02-21',
      show_birthday_in_calendar: true,
      phone: '+972500000005',
      email: 'student5@school.local',
      document_type: 'passport',
      document_number: 'S-500001',
      initial_password: '123456',
      known_languages: ['ru', 'en'],
    },
    {
      id: 'user_student_2',
      name: 'Ева Аракчеева',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=EvaStudent',
      login: 'student52',
      password_hash: PASSWORD,
      role_id: 5,
      preferred_language: 'ru',
      is_homeroom: false,
      class_ids: ['class_g1'],
      child_ids: [],
      is_active: true,
      dob: '2016-04-09',
      show_birthday_in_calendar: true,
      phone: '+972500000052',
      email: 'student52@school.local',
      document_type: 'passport',
      document_number: 'S-500052',
      initial_password: '123456',
      known_languages: ['ru'],
    },
    {
      id: 'user_staff_1',
      name: 'Сара',
      photo_uri: 'https://api.dicebear.com/9.x/adventurer/png?seed=SaraStaff',
      login: 'staff6',
      password_hash: PASSWORD,
      role_id: 6,
      preferred_language: 'ru',
      is_homeroom: false,
      class_ids: ['class_g1'],
      child_ids: [],
      is_active: true,
      dob: '1976-02-21',
      show_birthday_in_calendar: true,
      phone: '+972500000006',
      email: 'staff6@school.local',
      document_type: 'passport',
      document_number: 'ST-600001',
      initial_password: '123456',
    },
  ],
  classes: [
    {
      id: 'class_g1',
      name: 'Класс 3-1',
      grade: '3',
      homeroom_teacher_id: null,
      name_i18n: {
        ru: 'Класс 3-1',
        en: 'Class 3-1',
        he: 'כיתה 3-1',
      },
      subject_ids: ['subject_hebrew', 'subject_math', 'subject_science'],
      is_archived: false,
    },
  ],
  subjects: [
    {
      id: 'subject_hebrew',
      name: 'Иврит',
      name_i18n: { ru: 'Иврит', en: 'Hebrew', he: 'עברית' },
      is_archived: false,
      archived_at: null,
      archived_mode: null,
    },
    {
      id: 'subject_math',
      name: 'Математика',
      name_i18n: { ru: 'Математика', en: 'Math', he: 'מתמטיקה' },
      is_archived: false,
      archived_at: null,
      archived_mode: null,
    },
    {
      id: 'subject_science',
      name: 'Естествознание',
      name_i18n: { ru: 'Естествознание', en: 'Science', he: 'מדעים' },
      is_archived: false,
      archived_at: null,
      archived_mode: null,
    },
  ],
  lessons: [
    {
      id: 'lesson_sun_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Иврит',
      room: '201',
      start_datetime: '2026-02-22T06:00:00.000Z',
      end_datetime: '2026-02-22T06:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_sun_2',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Математика',
      room: '201',
      start_datetime: '2026-02-22T06:50:00.000Z',
      end_datetime: '2026-02-22T07:40:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_sun_3',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Естествознание',
      room: 'Лаборатория 1',
      start_datetime: '2026-02-22T08:05:00.000Z',
      end_datetime: '2026-02-22T08:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_mon_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'История',
      room: '203',
      start_datetime: '2026-02-23T06:00:00.000Z',
      end_datetime: '2026-02-23T06:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_mon_2_old',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Математика',
      room: '201',
      start_datetime: '2026-02-23T06:50:00.000Z',
      end_datetime: '2026-02-23T07:40:00.000Z',
      type: 'lesson',
      status: 'canceled',
      original_reference_id: null,
      change_reason: 'Учитель заболел. Урок заменён занятием по робототехнике.',
    },
    {
      id: 'lesson_mon_2_new',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Робототехника',
      room: 'Технический кабинет',
      start_datetime: '2026-02-23T06:50:00.000Z',
      end_datetime: '2026-02-23T07:40:00.000Z',
      type: 'lesson',
      status: 'changed',
      original_reference_id: 'lesson_mon_2_old',
      change_reason: 'Учитель заболел. Урок заменён занятием по робототехнике.',
    },
    {
      id: 'lesson_mon_3',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Английский язык',
      room: '204',
      start_datetime: '2026-02-23T08:05:00.000Z',
      end_datetime: '2026-02-23T08:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_tue_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Иврит',
      room: '201',
      start_datetime: '2026-02-24T06:00:00.000Z',
      end_datetime: '2026-02-24T06:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_tue_2',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'ИЗО',
      room: 'Студия',
      start_datetime: '2026-02-24T06:50:00.000Z',
      end_datetime: '2026-02-24T07:40:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_tue_3',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Физкультура',
      room: 'Спортзал',
      start_datetime: '2026-02-24T08:05:00.000Z',
      end_datetime: '2026-02-24T08:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_wed_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Математика',
      room: '201',
      start_datetime: '2026-02-25T06:00:00.000Z',
      end_datetime: '2026-02-25T06:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_wed_2',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'География',
      room: '203',
      start_datetime: '2026-02-25T06:50:00.000Z',
      end_datetime: '2026-02-25T07:40:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_wed_3',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Информатика',
      room: 'Кабинет информатики 2',
      start_datetime: '2026-02-25T08:05:00.000Z',
      end_datetime: '2026-02-25T08:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_thu_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Английский язык',
      room: '204',
      start_datetime: '2026-02-26T06:00:00.000Z',
      end_datetime: '2026-02-26T06:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_thu_2',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'История',
      room: '203',
      start_datetime: '2026-02-26T06:50:00.000Z',
      end_datetime: '2026-02-26T07:40:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_thu_3',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Музыка',
      room: 'Музыкальный зал',
      start_datetime: '2026-02-26T08:05:00.000Z',
      end_datetime: '2026-02-26T08:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_fri_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Общая линейка',
      room: 'Актовый зал',
      start_datetime: '2026-02-27T06:00:00.000Z',
      end_datetime: '2026-02-27T06:50:00.000Z',
      type: 'requirement',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_fri_2',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'Классное мероприятие: подготовка к шаббату',
      room: 'Класс',
      start_datetime: '2026-02-27T06:50:00.000Z',
      end_datetime: '2026-02-27T07:40:00.000Z',
      type: 'event',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
    {
      id: 'lesson_fri_3',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      subject: 'ИЗО',
      room: 'Студия',
      start_datetime: '2026-02-27T08:05:00.000Z',
      end_datetime: '2026-02-27T08:50:00.000Z',
      type: 'lesson',
      status: 'normal',
      original_reference_id: null,
      change_reason: null,
    },
  ],
  homework: [
    {
      id: 'hw_1',
      lesson_id: 'lesson_sun_1',
      class_id: 'class_g1',
      teacher_id: 'user_teacher_1',
      text: 'Прочитать страницу 12 и ответить на вопросы.',
      text_original: 'Прочитать страницу 12 и ответить на вопросы.',
      lang_original: 'ru',
      translations: buildTranslations('Прочитать страницу 12 и ответить на вопросы.', 'ru'),
      assigned_date: '2026-02-22',
      due_date: '2026-02-24',
      attachments: [
        'https://picsum.photos/seed/homework_mark/800/600.jpg',
        'https://samplelib.com/lib/preview/mp3/sample-3s.mp3',
      ],
      student_confirmed_ids: [],
      parent_confirmed_ids: [],
      source: 'manual',
      ocr_raw_text: null,
      created_at: '2026-02-22T10:00:00.000Z',
      updated_at: '2026-02-22T10:00:00.000Z',
    },
  ],
  threads: [
    {
      id: 'thread_parent_teacher_1',
      type: 'parent_teacher',
      participants: ['user_teacher_1', 'user_parent_1'],
      class_id: 'class_g1',
    },
    {
      id: 'thread_class_announcement_1',
      type: 'class',
      participants: [
        'user_teacher_1',
        'user_parent_1',
        'user_student_1',
        'user_student_2',
        'user_director_1',
        'user_admin_7',
        'user_staff_1',
      ],
      class_id: 'class_g1',
    },
    {
      id: 'thread_director_all',
      type: 'announcement',
      participants: [
        'user_director_1',
        'user_admin_7',
        'user_teacher_1',
        'user_parent_1',
        'user_student_1',
        'user_student_2',
        'user_staff_1',
      ],
      class_id: null,
    },
  ],
  messages: [
    makeMessage({
      id: 'msg_1',
      thread_id: 'thread_parent_teacher_1',
      sender_id: 'user_parent_1',
      text_original: 'Здравствуйте, Марк будет отсутствовать на первом уроке завтра.',
      lang_original: 'ru',
      attachments: [],
      created_at: '2026-02-22T12:10:00.000Z',
      read_by: ['user_parent_1'],
    }),
    makeMessage({
      id: 'msg_2',
      thread_id: 'thread_parent_teacher_1',
      sender_id: 'user_teacher_1',
      text_original: 'Спасибо за уведомление. Отметила в журнале.',
      lang_original: 'ru',
      attachments: [],
      created_at: '2026-02-22T12:20:00.000Z',
      read_by: ['user_teacher_1'],
    }),
    makeMessage({
      id: 'msg_3',
      thread_id: 'thread_director_all',
      sender_id: 'user_director_1',
      text_original: 'Добро пожаловать в новый школьный сервис-прототип.',
      lang_original: 'ru',
      attachments: [],
      created_at: '2026-02-22T07:00:00.000Z',
      read_by: ['user_director_1'],
    }),
  ],
  feedback: [
    {
      id: 'feedback_1',
      author_id: 'user_parent_1',
      visibility_roles: [1, 2, 3, 7],
      is_private_to_author: false,
      class_id: 'class_g1',
      text_original: 'Хотелось бы больше проектов по робототехнике.',
      lang_original: 'ru',
      translations: buildTranslations('Хотелось бы больше проектов по робототехнике.', 'ru'),
      status: 'new',
    },
    {
      id: 'feedback_2',
      author_id: 'user_parent_1',
      visibility_roles: [1, 7],
      is_private_to_author: true,
      class_id: 'class_g1',
      text_original: 'Личное замечание директору.',
      lang_original: 'ru',
      translations: buildTranslations('Личное замечание директору.', 'ru'),
      status: 'new',
    },
    {
      id: 'feedback_3',
      author_id: 'user_student_1',
      visibility_roles: [1, 3, 5, 7],
      is_private_to_author: false,
      class_id: 'class_g1',
      category: 'furniture',
      text_original: 'В 201 кабинете качается парта.',
      lang_original: 'ru',
      translations: buildTranslations('В 201 кабинете качается парта.', 'ru'),
      status: 'planned',
    },
  ],
  absence: [],
  lesson_reports: [],
  student_lesson_records: [],
  extra_classes: [
    {
      id: 'extra_1',
      title: 'Кружок робототехники',
      description: 'Занятие по робототехнике после уроков',
      datetime: '2026-02-24T13:00:00.000Z',
      max_slots: 20,
    },
  ],
  signups: [
    {
      id: 'signup_1',
      extra_class_id: 'extra_1',
      student_id: 'user_student_1',
      status: 'approved',
    },
  ],
  applications: [
    {
      id: 'app_parent_1',
      type: 'parent_with_student',
      status: 'new',
      created_at: '2026-02-20T08:30:00.000Z',
      updated_at: '2026-02-20T08:30:00.000Z',
      parent_data: {
        first_name: 'Елена',
        last_name: 'Коваль',
        phone: '+972523334455',
        phone_verified: true,
        email: 'elena.koval@example.com',
        document_type: 'teudat_zeut',
        document_number: '123456789',
        relation: 'mother',
        consent_personal_data: true,
      },
      student_data: {
        first_name: 'Лев',
        last_name: 'Коваль',
        birth_date: '2018-09-17',
        photo: {
          id: 'file_student_photo_1',
          name: 'lev-photo.jpg',
          uri: 'mock://files/lev-photo.jpg',
          uploaded_at: '2026-02-20T08:29:10.000Z',
        },
        document_type: 'passport',
        document_number: 'X1234567',
        document_files: [
          {
            id: 'file_student_doc_1',
            name: 'student-passport-front.jpg',
            uri: 'mock://files/student-passport-front.jpg',
            uploaded_at: '2026-02-20T08:29:40.000Z',
          },
        ],
      },
      reviewer_user_id: null,
      review_comment: null,
      missing_info_request: null,
      approved_user_ids: [],
      assigned_class_ids: [],
    },
    {
      id: 'app_staff_1',
      type: 'staff',
      status: 'in_review',
      created_at: '2026-02-20T10:00:00.000Z',
      updated_at: '2026-02-20T14:10:00.000Z',
      staff_data: {
        first_name: 'Давид',
        last_name: 'Леви',
        phone: '+972501112233',
        phone_verified: true,
        email: 'david.levi@example.com',
        document_type: 'passport',
        document_number: 'P-7788990',
        document_files: [
          {
            id: 'file_staff_doc_1',
            name: 'passport.pdf',
            uri: 'mock://files/passport.pdf',
            uploaded_at: '2026-02-20T09:59:20.000Z',
          },
        ],
        role: 'teacher',
        subjects: ['Математика', 'Иврит'],
        class_ids: ['class_g1'],
        years_experience: 8,
        diploma_files: [
          {
            id: 'file_staff_diploma_1',
            name: 'diploma.pdf',
            uri: 'mock://files/diploma.pdf',
            uploaded_at: '2026-02-20T09:59:40.000Z',
          },
        ],
        planned_start_date: '2026-03-01',
        comment: 'Готов выйти в следующем месяце.',
      },
      reviewer_user_id: 'user_admin_7',
      review_comment: 'Проверяются документы.',
      missing_info_request: null,
      approved_user_ids: [],
      assigned_class_ids: [],
    },
  ],
  staff_schedules: [
    {
      id: 'staff_schedule_1',
      staff_user_id: 'user_teacher_1',
      days_of_week: [0, 1, 2, 3, 4],
      start_time: '08:00',
      end_time: '15:00',
      starts_on: '2026-02-22',
      ends_on: null,
      assigned_by_user_id: 'user_admin_7',
      created_at: '2026-02-19T12:00:00.000Z',
    },
  ],
  staff_schedule_exceptions: [
    {
      id: 'staff_exception_1',
      schedule_id: 'staff_schedule_1',
      date: '2026-02-24',
      start_time: '10:00',
      end_time: '15:00',
      reason: 'Медицинский приём',
      created_by_user_id: 'user_admin_7',
    },
  ],
  devices: [
    {
      id: 'device_bind_1',
      user_id: 'user_parent_1',
      device_id: 'dev-parent-iphone-001',
      platform: 'ios',
      is_active: true,
      created_at: '2026-02-18T07:00:00.000Z',
      last_seen_at: '2026-02-21T07:10:00.000Z',
      deactivated_at: null,
    },
    {
      id: 'device_bind_2',
      user_id: 'user_parent_1',
      device_id: 'dev-parent-old-000',
      platform: 'ios',
      is_active: false,
      created_at: '2026-01-10T10:00:00.000Z',
      last_seen_at: '2026-02-01T12:00:00.000Z',
      deactivated_at: '2026-02-02T12:00:00.000Z',
    },
  ],
  admin_logs: [
    {
      id: 'admin_log_1',
      actor_user_id: 'user_admin_7',
      action: 'APPLICATION_IN_REVIEW',
      entity_type: 'application',
      entity_id: 'app_staff_1',
      created_at: '2026-02-20T14:10:00.000Z',
      details: 'Статус изменён на In Review.',
    },
  ],
  notifications: [
    {
      id: 'notif_1',
      user_id: 'user_parent_1',
      title: 'Ваша заявка отправлена',
      body: 'Ожидайте проверки администратора.',
      created_at: '2026-02-20T08:31:00.000Z',
      is_read: false,
    },
  ],
  parent_student_relations: [],
};

export function createSeedDatabase(): DatabaseSnapshot {
  return JSON.parse(JSON.stringify(seed)) as DatabaseSnapshot;
}
